/*! fireNav (0.3.0) (C) 2014 CJ O'Hara. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(t,e,i,a){function n(e,i,a){this.$el=t(e),this.selector=a,this.options=i,this._name=o,this._defaults=r,this._attribures=l.getData(this.$el.data()),this.options=t.extend({},r,i,this._attribures),this.init()}function s(e,i,a){this.$el=t(e),this.selector=a,this.options=i,this._name=c,this._defaults=p,this._attribures=l.getData(this.$el.data()),this.options=t.extend({},p,i,this._attribures),this.init()}var o="fireNavJump",c="fireNavTabs",r={jumpItemTemplate:'<li class="firenav-jump-section-item">{{ jump_link }}</li>',jumpLinkClass:"firenav-jump-link",jumpSectionActiveClass:"firenav-jump-active",jumpSectionTemplate:'<ul class="firenav-jump-section-{{ depth }}"></ul>',offset:0,speed:800,updateHash:!1,watchScroll:!0},p={activeTabClass:"firenav-tab-active",activeTabLinkClass:"firenav-tab-link-active",loadHash:!0};n.prototype={init:function(){var e=this;return"undefined"===t.type(t.Velocity)?(console.log("%cWARNING: fireSlider requires velocity.js to run correctly.","background: #E82C0C; color: white; padding: 0 12px;"),!1):(e.options.sections instanceof jQuery||(e.options.sections=t(".firenav-section")),e.createSectionIds()?(e.jumpLinks=t(),e.constructJumpNav(),e.options.updateHash?e.loadWindowHash():e.updateActiveSection(),e.addJumpNavClickEvents(),e.initFunctions(),void e.bindEvents()):!1)},createSectionIds:function(){var e=this;return e.options.sections.each(function(i){var a=t(this).data(),n=a.firenavJumpName?a.firenavJumpName:"",s=t(this).parents(e.options.sections.selector).first(),o=l.cleanString(n);return o=s.length?s.get(0).id+"-"+o:o,o=t(this).get(0).id?t(this).get(0).id:o,t(this).attr("id",o),""===t(this).get(0).id&&""===o?(console.log('%cWARNING: Neither "data-firenav-jump-name" or "id" was found on section '+(i+1)+".","background: #E82C0C; color: white; padding: 0px 12px;"),!1):void 0}),!0},constructJumpNav:function(){var t=this,e=0,i=t.options.sections,a=t.createNavListSection(0),n=t.options.sections.selector;t.loadSections(e,i,a,n),t.$el.append(a)},createNavListSection:function(e){var i=this,a=i.parseJumpSectionTemplateTags(i.options.jumpSectionTemplate,e);return t(a)},parseJumpSectionTemplateTags:function(t,e){var i=t,a=l.getTemplateTagRegex("depth");return-1!==i.search(a)&&(i=i.replace(a,(e+1).toString())),i},loadSections:function(t,e,i,a){var n=this,s=n.getSectionAtDepth(t,e,a);0!==s.length&&(n.processSection(t,s,i,a),t++,n.loadSections(t,e,i,a))},getSectionAtDepth:function(e,i,a){var n=t();return i.each(function(){t(this).parents(a).length===e&&(n=n.add(t(this)))}),n},processSection:function(e,i,a,n){var s=this;i.each(function(){var i=s.createNavListItem(t(this),e);if(t(this).find(n).length>0){var o=s.createNavListSection(e);i.append(o)}var c=t(this).parents(n).first();if(c.length>0){var r="#"+c.get(0).id,p=a.find('a[href="'+r+'"]').parent(),l=p.find("ul");l.append(i)}else a.append(i)})},createNavListItem:function(e,i){var a=this,n=(e.data(),a.parseJumpItemTemplateTags(e,a.options.jumpItemTemplate,i)),s=t(n);return a.jumpLinks=a.jumpLinks.add(s),s},parseJumpItemTemplateTags:function(t,e,i){var a=this,n=e,s=t.data(),o=l.getTemplateTagRegex("depth");-1!==n.search(o)&&(n=n.replace(o,(i+1).toString()));var c=l.getTemplateTagRegex("jump_link");if(-1!==n.search(c)){var r="#"+t.get(0).id,p=s.firenavJumpName?s.firenavJumpName:t.get(0).id,u=a.options.jumpLinkClass,h='<a href="'+r+'" class="'+u+'">'+p+"</a>";n=n.replace(c,h)}var v=l.getTemplateTagRegex("jump_name");if(-1!==n.search(v)){var f=s.firenavJumpName?s.firenavJumpName:t.get(0).id;n=n.replace(v,f)}return n},loadWindowHash:function(){var i=this,n=e.location.hash;i.jumpLinks.each(function(){t(this).find("a").attr("href")===n&&(i.activeSection=t(n))}),i.updateActiveLinkClass(a,i.activeSection,i.options.jumpSectionActiveClass)},updateActiveSection:function(){var e=this,i=e.getActiveSection();if(!(e.activeSection instanceof jQuery&&e.activeSection.is(i))){var a=e.activeSection?e.activeSection:t();e.activeSection=i,e.updateActiveLinkClass(a,i,e.options.jumpSectionActiveClass)}},getActiveSection:function(){var e=this,i=t(),a=-1;return e.options.sections.each(function(){var n=t(this).get(0).getBoundingClientRect().top;Math.floor(n)<=e.options.offset&&(n>a||-1===a)&&(a=n,i=t(this))}),i},updateActiveLinkClass:function(e,i,a){var n=this;if(n.jumpLinks.each(function(){e&&t(this).find("a").attr("href")==="#"+e.attr("id")&&t(this).removeClass(a),i&&t(this).find("a").attr("href")==="#"+i.attr("id")&&t(this).addClass(a)}),i&&i.length>0){var s=i.data(),o=s.firenavJumpClass?s.firenavJumpClass:"";""!==n.activeJumpClass&&n.$el.removeClass(n.activeJumpClass),""!==o&&(n.activeJumpClass=o,n.$el.addClass(o))}},addJumpNavClickEvents:function(){var e=this;e.jumpLinks.find("a").each(function(){t(this).click(function(i){i.preventDefault();t(this).attr("href");e.options.sections.filter(t(this).attr("href")).velocity("scroll",{duration:e.options.speed,easing:"ease-in-out",offset:e.options.offset,complete:function(){var i=e.activeSection;t(this).is(i)||(e.activeSection=t(this),e.updateActiveLinkClass(i,t(this),e.options.jumpSectionActiveClass)),e.updatePageUrl("#"+t(this).attr("id"))}})})})},updatePageUrl:function(t){var i=this;i.options.updateHash&&(history.replaceState?history.replaceState(a,a,t):e.location.replace&&e.location.replace(t))},initFunctions:function(){var i=this;i.destroy=function(){i.$el.trigger("fireNav:jump:destroy")},t(e).scroll(function(){i.$el.trigger("fireNav:jump:scroll")})},bindEvents:function(){var t=this;t.$el.on("fireNav:jump:destroy",function(){t.unbindEvents(),t.$el.empty()}),t.$el.on("fireNav:jump:scroll",function(){var e=t.activeSection;t.updateActiveSection(),t.activeSection!==e&&t.updatePageUrl("#"+t.activeSection.get(0).id)})},unbindEvents:function(){var t=this;t.$el.off("fireNav:jump:scroll")}},s.prototype={init:function(){var i=this;i.options.tabs instanceof jQuery||(i.options.tabs=t(".tab")),this.constructTabNav(),this.addListeners(),this.options.tabs.css("display","none");var a=e.location.hash,n=this.$el.find('a[href="'+a+'"]'),s=this.options.tabs.filter(a);this.activeLink=this.options.loadHash&&n.length?n:this.$el.find("a").first(),this.activeTab=this.options.loadHash&&s.length?s:this.options.tabs.first(),this.updateActiveTab(this.activeLink,this.activeTab),this.initFunctions(),this.bindEvents()},constructTabNav:function(){var e=this,i=t("<ul></ul>");e.options.tabs.each(function(){var e=t(this).data(),a=e.firenavTab?e.firenavTab:"",n=l.cleanString(a);t(this).attr("id",n),i.append('<li><a href="#'+n+'">'+a+"</a></li>")}),e.$el.append(i)},addListeners:function(){var i=this;i.$el.find("a").each(function(){t(this).click(function(n){n.preventDefault();var s=t(this).attr("href");i.updateActiveTab(t(this),i.options.tabs.filter(s)),i.options.loadHash&&(history.replaceState?history.replaceState(a,a,s):e.location.replace&&e.location.replace(s))})})},updateActiveTab:function(t,e){var i=this;i.activeLink&&i.activeLink instanceof jQuery&&i.activeLink.parent("li").removeClass(i.options.activeTabLinkClass),i.activeTab&&i.activeTab instanceof jQuery&&i.activeTab.css("display","none").removeClass(i.options.activeTabClass),e.css("display","block").addClass(i.options.activeTabClass),t.parent("li").addClass(i.options.activeTabLinkClass),i.activeLink=t,i.activeTab=e},initFunctions:function(){var t=this;t.destroy=function(){t.$el.trigger("fireNav:tabs:destroy")}},bindEvents:function(){var t=this;t.$el.on("fireNav:tabs:destroy",function(){t.$el.empty()})}};var l={cleanString:function(t){return t.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/&#{0,1}[a-z0-9]+;/gi,"").replace(/[^\w\s]/gi,"").replace(/\s+/g,"-")},getData:function(e){return t.each(e,function(i,a){t.each(["firenav","fire-nav"],function(t,a){if(i.toLowerCase().indexOf(a)>-1&&i!==o&&i!==c){var n=i.replace(new RegExp(a,"gi"),"");n=n.charAt(0).toLowerCase()+n.slice(1),e[n]=e[i],delete e[i]}})}),e},getTemplateTagRegex:function(t){return new RegExp("{{\\s*"+t+"\\s*}}","g")}};t.fn[o]=function(e){var i=this.selector;return this.each(function(){t.data(this,o)&&(t(this).data(o).destroy(),t(this).removeData(o)),t.data(this,o,new n(this,e,i))})},t.fn[c]=function(e){var i=this.selector;return this.each(function(){t.data(this,c)&&(t(this).data(c).destroy(),t(this).removeData(c)),t.data(this,c,new s(this,e,i))})},e.fireNavJump=n,e.fireNavTabs=s}(jQuery,window,document);