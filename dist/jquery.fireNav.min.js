/*! fireNav (0.3.0) (C) 2014 CJ O'Hara. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(t,e,i,a){function s(e,i,a){this.$el=t(e),this.selector=a,this.options=i,this._name=o,this._defaults=r,this._attribures=h.getData(this.$el.data()),this.options=t.extend({},r,i,this._attribures),this.init()}function n(e,i,a){this.$el=t(e),this.selector=a,this.options=i,this._name=c,this._defaults=p,this._attribures=h.getData(this.$el.data()),this.options=t.extend({},p,i,this._attribures),this.init()}var o="fireNavJump",c="fireNavTabs",r={jumpItemTemplate:'<li class="firenav-jump-section-item">{{ jump_link }}</li>',jumpLinkClass:"firenav-jump-link",jumpSectionActiveClass:"firenav-jump-active",jumpSectionTemplate:'<ul class="firenav-jump-section-{{ depth }}"></ul>',offset:0,speed:800,updateHash:!1,watchScroll:!0},p={activeTabClass:"firenav-tab-active",activeTabLinkClass:"firenav-tab-link-active",loadHash:!0};s.prototype={init:function(){var e=this;return"undefined"===t.type(t.Velocity)?(console.log("%cWARNING: fireSlider requires velocity.js to run correctly.","background: #E82C0C; color: white; padding: 0 12px;"),!1):(e.options.sections instanceof jQuery||(e.options.sections=t(".firenav-section")),e.createSectionIds()?(e.jumpLinks=t(),e.constructJumpNav(),e.options.updateHash?e.loadWindowHash():e.updateActiveSection(),void e.addJumpNavClickEvents()):!1)},createSectionIds:function(){var e=this;return e.options.sections.each(function(i){var a=t(this).data(),s=a.firenavJumpName?a.firenavJumpName:"",n=t(this).parents(e.options.sections.selector).first(),o=h.cleanString(s);return o=n.length?n.get(0).id+"-"+o:o,o=t(this).get(0).id?t(this).get(0).id:o,t(this).attr("id",o),""===t(this).get(0).id&&""===o?(console.log('%cWARNING: Neither "data-firenav-jump-name" or "id" was found on section '+(i+1)+".","background: #E82C0C; color: white; padding: 0px 12px;"),!1):void 0}),!0},constructJumpNav:function(){var t=this,e=0,i=t.options.sections,a=t.createNavListSection(0),s=t.options.sections.selector;t.loadSections(e,i,a,s),t.$el.append(a)},createNavListSection:function(e){var i=this,a=i.parseJumpSectionTemplateTags(i.options.jumpSectionTemplate,e);return t(a)},parseJumpSectionTemplateTags:function(t,e){var i=t,a=h.getTemplateTagRegex("depth");return-1!==i.search(a)&&(i=i.replace(a,(e+1).toString())),i},loadSections:function(t,e,i,a){var s=this,n=s.getSectionAtDepth(t,e,a);0!==n.length&&(s.processSection(t,n,i,a),t++,s.loadSections(t,e,i,a))},getSectionAtDepth:function(e,i,a){var s=t();return i.each(function(){t(this).parents(a).length===e&&(s=s.add(t(this)))}),s},processSection:function(e,i,a,s){var n=this;i.each(function(){var i=n.createNavListItem(t(this),e);if(t(this).find(s).length>0){var o=n.createNavListSection(e);i.append(o)}var c=t(this).parents(s).first();if(c.length>0){var r="#"+c.get(0).id,p=a.find('a[href="'+r+'"]').parent(),h=p.find("ul");h.append(i)}else a.append(i)})},createNavListItem:function(e,i){var a=this,s=(e.data(),a.parseJumpItemTemplateTags(e,a.options.jumpItemTemplate,i)),n=t(s);return a.jumpLinks=a.jumpLinks.add(n),n},parseJumpItemTemplateTags:function(t,e,i){var a=this,s=e,n=t.data(),o=h.getTemplateTagRegex("depth");-1!==s.search(o)&&(s=s.replace(o,(i+1).toString()));var c=h.getTemplateTagRegex("jump_link");if(-1!==s.search(c)){var r="#"+t.get(0).id,p=n.firenavJumpName?n.firenavJumpName:t.get(0).id,l=a.options.jumpLinkClass,u='<a href="'+r+'" class="'+l+'">'+p+"</a>";s=s.replace(c,u)}var v=h.getTemplateTagRegex("jump_name");if(-1!==s.search(v)){var f=n.firenavJumpName?n.firenavJumpName:t.get(0).id;s=s.replace(v,f)}return s},loadWindowHash:function(){var i=this,s=e.location.hash;i.jumpLinks.each(function(){t(this).find("a").attr("href")===s&&(i.activeSection=t(s))}),i.updateActiveLinkClass(a,i.activeSection,i.options.jumpSectionActiveClass)},updateActiveSection:function(){var e=this,i=e.getActiveSection();if(e.activeSection!==i){var a=e.activeSection?e.activeSection:t();e.activeSection=i,e.updateActiveLinkClass(a,i,e.options.jumpSectionActiveClass)}},updateActiveLinkClass:function(e,i,a){var s=this;if(s.jumpLinks.each(function(){e&&t(this).find("a").attr("href")==="#"+e.attr("id")&&t(this).removeClass(a),t(this).find("a").attr("href")==="#"+i.attr("id")&&t(this).addClass(a)}),i.length>0){var n=i.data(),o=n.firenavJumpClass?n.firenavJumpClass:"";""!==s.activeJumpClass&&s.$el.removeClass(s.activeJumpClass),""!==o&&(s.activeJumpClass=o,s.$el.addClass(o))}},getActiveSection:function(){var e=this,i=t(),a=-1;return e.options.sections.each(function(){var s=t(this).scrollTop();Math.floor(s)<=e.options.offset&&(s>a||-1===a)&&(a=s,i=t(this))}),i},addJumpNavClickEvents:function(){var e=this;e.jumpLinks.find("a").each(function(){t(this).click(function(i){i.preventDefault();var a=(t(this).attr("href"),e.options.sections.filter(t(this).attr("href")).velocity("scroll",{duration:e.options.speed,easing:"ease-in-out",offset:e.options.offset})),s=e.activeSection;a!==s&&(e.activeSection=a,e.updateActiveLinkClass(s,a,e.options.jumpSectionActiveClass))})})}},n.prototype={init:function(){var i=this;i.options.tabs instanceof jQuery||(i.options.tabs=t(".tab")),this.constructTabNav(),this.addListeners(),this.options.tabs.css("display","none");var a=e.location.hash,s=this.$el.find('a[href="'+a+'"]'),n=this.options.tabs.filter(a);this.activeLink=this.options.loadHash&&s.length?s:this.$el.find("a").first(),this.activeTab=this.options.loadHash&&n.length?n:this.options.tabs.first(),this.updateActiveTab(this.activeLink,this.activeTab)},constructTabNav:function(){var e=this,i=t("<ul></ul>");e.options.tabs.each(function(){var e=t(this).data(),a=e.firenavTab?e.firenavTab:"",s=h.cleanString(a);t(this).attr("id",s),i.append('<li><a href="#'+s+'">'+a+"</a></li>")}),e.$el.append(i)},addListeners:function(){var i=this;i.$el.find("a").each(function(){t(this).click(function(s){s.preventDefault();var n=t(this).attr("href");i.updateActiveTab(t(this),i.options.tabs.filter(n)),i.options.loadHash&&(history.replaceState?history.replaceState(a,a,n):e.location.replace&&e.location.replace(n))})})},updateActiveTab:function(t,e){var i=this;i.activeLink&&i.activeLink instanceof jQuery&&i.activeLink.parent("li").removeClass(i.options.activeTabLinkClass),i.activeTab&&i.activeTab instanceof jQuery&&i.activeTab.css("display","none").removeClass(i.options.activeTabClass),e.css("display","block").addClass(i.options.activeTabClass),t.parent("li").addClass(i.options.activeTabLinkClass),i.activeLink=t,i.activeTab=e}};var h={cleanString:function(t){return t.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/&#{0,1}[a-z0-9]+;/gi,"").replace(/[^\w\s]/gi,"").replace(/\s+/g,"-")},getData:function(e){return t.each(e,function(i,a){t.each(["firenav","fire-nav"],function(t,a){if(i.toLowerCase().indexOf(a)>-1&&i!==o&&i!==c){var s=i.replace(new RegExp(a,"gi"),"");s=s.charAt(0).toLowerCase()+s.slice(1),e[s]=e[i],delete e[i]}})}),e},getTemplateTagRegex:function(t){return new RegExp("{{\\s*"+t+"\\s*}}","g")}};t.fn[o]=function(e){var i=this.selector;return this.each(function(){t.data(this,o)&&(t(this).data(o).destroy(),t(this).removeData(fireNav)),t.data(this,o,new s(this,e,i))})},t.fn[c]=function(e){var i=this.selector;return this.each(function(){t.data(this,c)&&(t(this).data(c).destroy(),t(this).removeData(c)),t.data(this,c,new n(this,e,i))})},e.fireNavJump=s,e.fireNavTabs=n}(jQuery,window,document);